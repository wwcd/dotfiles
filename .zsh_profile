#!/bin/zsh

if [[ ! -d ~/.zplug ]]; then
  git clone https://github.com/zplug/zplug ~/.zplug
  source ~/.zplug/init.zsh && zplug update --self
else
  source ~/.zplug/init.zsh
fi

# completion
setopt noautomenu
fpath=(~/.zsh/completion /usr/share/zsh/vendor-completions $fpath)
autoload -Uz compinit && compinit -i

# History
export HISTFILE=$HOME/.zsh_history
export HISTSIZE=100000
export SAVEHIST=$HISTSIZE
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_REDUCE_BLANKS
setopt INC_APPEND_HISTORY
setopt SHARE_HISTORY

# misc
bindkey \^U backward-kill-line

# Themes
zplug "mafredri/zsh-async", from:github, use:"async.zsh"
zplug "sindresorhus/pure", from:github, use:"pure.zsh", as:theme
export PURE_GIT_PULL=1

# Tools
zplug "stedolan/jq", from:gh-r, as:command, rename-to:jq
zplug "BurntSushi/ripgrep", from:gh-r, as:command, rename-to:rg, use:"*x86_64*musl*"
zplug "dbrgn/tealdeer", from:gh-r, as:command, rename-to:tldr, use:"*linux*x86_64*musl"
zplug "sharkdp/fd", from:gh-r, as:command, rename-to:fd, use:"*x86_64*linux*musl*"
zplug "sharkdp/bat", from:gh-r, as:command, rename-to:bat, use:"*linux-musl*"
zplug "dandavison/delta", from:gh-r, as:command, rename-to:delta, use:"*x86_64*linux*musl*"
zplug "Peltoche/lsd", from:gh-r, as:command, rename-to:lsd, use:"*x86_64*linux*musl*"
zplug "bootandy/dust", from:gh-r, as:command, rename-to:dust, use:"*x86_64*linux*musl*"
zplug "muesli/duf", from:gh-r, as:command, rename-to:duf, use:"*linux_x86_64*"

# FZF
zplug "junegunn/fzf-bin", from:gh-r, as:command, rename-to:fzf, use:"*linux*amd64*"
zplug "junegunn/fzf", use:"shell/*.zsh"
export FZF_DEFAULT_COMMAND='fd --type f --color never'
export FZF_DEFAULT_OPTS='--color=bg+:-1,bg:-1 --preview-window=0'
export FZF_CTRL_T_COMMAND='fd --type f --color never'
export FZF_ALT_C_COMMAND='fd --type d --color never'

# J
zplug "ajeetdsouza/zoxide", from:gh-r, as:command, rename-to:zoxide, use:"*x86_64*linux*musl*"
eval "$(zoxide init zsh)"
# zplug "rupa/z", use:"*.sh"
# zplug "wting/autojump", use:"bin/autojump", as:command, rename-to:autojump

# Awesome
zplug "zsh-users/zsh-syntax-highlighting", defer:2
zplug "zsh-users/zsh-completions"
zplug "zsh-users/zsh-autosuggestions"
# zplug "supercrabtree/k"

# Install plugins if there are plugins that have not been installed
if ! zplug check --verbose; then
  printf "Install? [y/N]: "
  if read -q; then
    echo; zplug install
  fi
fi

# Then, source plugins and add commands to $PATH
zplug load #--verbose

# vim: sw=2 ts=2 et
